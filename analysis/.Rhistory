geom_point(alpha = 0.8, size = 2) +
stat_ellipse(type = "norm") +
labs(x = "Principal Component 1 (44.6%)",
y = "Principal Component 2 (30.8%)") +
scale_colour_manual(values = c("#0A537D", "#7d340a", "#b6dfe2")) +
lims(x = c(-10,10),
y = c(-10,10)) +
coord_fixed() +
theme_minimal() +
theme(text = element_text(family = "Roboto", size = 10, colour = "grey20"),
plot.margin = margin(10, 10, 10, 10),
legend.position = "bottom",
legend.title = element_blank(),
legend.text  = element_text(size = 11),
axis.title.x = element_text(size = 11, margin = margin(10,0,0,0)),
axis.title.y = element_text(size = 11, margin = margin(0,10,0,0)),
panel.grid.major = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
axis.ticks = element_blank())
data_recipe %>%
juice() %>%
dplyr::rename(Delivery = delivery) %>%
ggplot(aes(PC2, PC3, colour = Delivery, shape = Delivery)) +
geom_point(alpha = 0.8, size = 2) +
stat_ellipse(type = "norm") +
labs(x = "Principal Component 2 (30.8%)",
y = "Principal Component 3 (10.0%)") +
scale_colour_manual(values = c("#0A537D", "#7d340a", "#b6dfe2")) +
lims(x = c(-10,10),
y = c(-10,10)) +
coord_fixed() +
theme_minimal() +
theme(text = element_text(family = "Roboto", size = 10, colour = "grey20"),
plot.margin = margin(10, 10, 10, 10),
legend.position = "bottom",
legend.title = element_blank(),
legend.text  = element_text(size = 11),
axis.title.x = element_text(size = 11, margin = margin(10,0,0,0)),
axis.title.y = element_text(size = 11, margin = margin(0,10,0,0)),
panel.grid.major = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
axis.ticks = element_blank())
data_recipe %>%
juice() %>%
dplyr::rename(Delivery = delivery) %>%
ggplot(aes(PC1, PC2, colour = proposed_grouping, shape = proposed_grouping)) +
geom_point(alpha = 0.8, size = 2) +
stat_ellipse(type = "norm") +
labs(x = "Principal Component 1 (44.6%)",
y = "Principal Component 2 (30.8%)") +
scale_colour_manual(values = c("#b6dfe2","#0A537D")) +
lims(x = c(-10,10),
y = c(-10,10)) +
coord_fixed() +
theme_minimal() +
theme(text = element_text(family = "Roboto", size = 10, colour = "grey20"),
plot.margin = margin(10, 10, 10, 10),
legend.position = "bottom",
legend.title = element_blank(),
legend.text  = element_text(size = 11),
axis.title.x = element_text(size = 11, margin = margin(10,0,0,0)),
axis.title.y = element_text(size = 11, margin = margin(0,10,0,0)),
panel.grid.major = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
axis.ticks = element_blank())
data_recipe %>%
juice() %>%
dplyr::rename(Delivery = delivery) %>%
ggplot(aes(PC2, PC3, colour = proposed_grouping, shape = proposed_grouping)) +
geom_point(alpha = 0.8, size = 2) +
stat_ellipse(type = "norm") +
labs(x = "Principal Component 2 (30.8%)",
y = "Principal Component 3 (10.0%)") +
scale_colour_manual(values = c("#b6dfe2","#0A537D")) +
lims(x = c(-10,10),
y = c(-10,10)) +
coord_fixed() +
theme_minimal() +
theme(text = element_text(family = "Roboto", size = 10, colour = "grey20"),
plot.margin = margin(10, 10, 10, 10),
legend.position = "bottom",
legend.title = element_blank(),
legend.text  = element_text(size = 11),
axis.title.x = element_text(size = 11, margin = margin(10,0,0,0)),
axis.title.y = element_text(size = 11, margin = margin(0,10,0,0)),
panel.grid.major = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
axis.ticks = element_blank())
data_recipe %>%
juice() %>%
dplyr::rename(Delivery = delivery) %>%
ggplot(aes(PC1, PC2, colour = proposed_grouping_2, shape = proposed_grouping_2)) +
geom_point(alpha = 0.8, size = 2) +
stat_ellipse(type = "norm") +
labs(x = "Principal Component 1 (44.6%)",
y = "Principal Component 2 (30.8%)") +
scale_colour_manual(values = c("#0A537D", "#7d340a", "#b6dfe2")) +
lims(x = c(-10,10),
y = c(-10,10)) +
coord_fixed() +
theme_minimal() +
theme(text = element_text(family = "Roboto", size = 10, colour = "grey20"),
plot.margin = margin(10, 10, 10, 10),
legend.position = "bottom",
legend.title = element_blank(),
legend.text  = element_text(size = 11),
axis.title.x = element_text(size = 11, margin = margin(10,0,0,0)),
axis.title.y = element_text(size = 11, margin = margin(0,10,0,0)),
panel.grid.major = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
axis.ticks = element_blank())
data_recipe %>%
juice() %>%
dplyr::rename(Delivery = delivery) %>%
ggplot(aes(PC2, PC3, colour = proposed_grouping_2, shape = proposed_grouping_2)) +
geom_point(alpha = 0.8, size = 2) +
stat_ellipse(type = "norm") +
labs(x = "Principal Component 2 (30.8%)",
y = "Principal Component 3 (10.0%)") +
scale_colour_manual(values = c("#0A537D", "#7d340a", "#b6dfe2")) +
lims(x = c(-10,10),
y = c(-10,10)) +
coord_fixed() +
theme_minimal() +
theme(text = element_text(family = "Roboto", size = 10, colour = "grey20"),
plot.margin = margin(10, 10, 10, 10),
legend.position = "bottom",
legend.title = element_blank(),
legend.text  = element_text(size = 11),
axis.title.x = element_text(size = 11, margin = margin(10,0,0,0)),
axis.title.y = element_text(size = 11, margin = margin(0,10,0,0)),
panel.grid.major = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
axis.ticks = element_blank())
data_recipe %>%
juice() %>%
dplyr::rename(Delivery = delivery) %>%
ggplot(aes(PC1, PC2, colour = Delivery, shape = Delivery)) +
geom_point(alpha = 0.8, size = 2) +
stat_ellipse(type = "norm") +
labs(x = "Principal Component 1 (44.6%)",
y = "Principal Component 2 (30.8%)") +
scale_colour_manual(values = c("#0A537D", "#7d340a", "#b6dfe2")) +
lims(x = c(-10,10),
y = c(-10,10)) +
coord_fixed() +
theme_minimal() +
theme(text = element_text(family = "Roboto", size = 10, colour = "grey20"),
plot.margin = margin(10, 10, 10, 10),
legend.position = "bottom",
legend.title = element_blank(),
legend.text  = element_text(size = 11),
axis.title.x = element_text(size = 11, margin = margin(10,0,0,0)),
axis.title.y = element_text(size = 11, margin = margin(0,10,0,0)),
panel.grid.major = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
axis.ticks = element_blank())
a <- data_recipe %>%
juice() %>%
dplyr::rename(Delivery = delivery) %>%
ggplot(aes(PC1, PC2, colour = Delivery, shape = Delivery)) +
geom_point(alpha = 0.8, size = 2) +
stat_ellipse(type = "norm") +
labs(x = "Principal Component 1 (44.6%)",
y = "Principal Component 2 (30.8%)") +
scale_colour_manual(values = c("#0A537D", "#7d340a", "#b6dfe2")) +
lims(x = c(-10,10),
y = c(-10,10)) +
coord_fixed() +
theme_minimal() +
theme(text = element_text(family = "Roboto", size = 10, colour = "grey20"),
plot.margin = margin(10, 10, 10, 10),
legend.position = "bottom",
legend.title = element_blank(),
legend.text  = element_text(size = 11),
axis.title.x = element_text(size = 11, margin = margin(10,0,0,0)),
axis.title.y = element_text(size = 11, margin = margin(0,10,0,0)),
panel.grid.major = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
axis.ticks = element_blank())
b <- data_recipe %>%
juice() %>%
dplyr::rename(Delivery = delivery) %>%
ggplot(aes(PC2, PC3, colour = Delivery, shape = Delivery)) +
geom_point(alpha = 0.8, size = 2) +
stat_ellipse(type = "norm") +
labs(x = "Principal Component 2 (30.8%)",
y = "Principal Component 3 (10.0%)") +
scale_colour_manual(values = c("#0A537D", "#7d340a", "#b6dfe2")) +
lims(x = c(-10,10),
y = c(-10,10)) +
coord_fixed() +
theme_minimal() +
theme(text = element_text(family = "Roboto", size = 10, colour = "grey20"),
plot.margin = margin(10, 10, 10, 10),
legend.position = "bottom",
legend.title = element_blank(),
legend.text  = element_text(size = 11),
axis.title.x = element_text(size = 11, margin = margin(10,0,0,0)),
axis.title.y = element_text(size = 11, margin = margin(0,10,0,0)),
panel.grid.major = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
axis.ticks = element_blank())
c <- data_recipe %>%
juice() %>%
dplyr::rename(Delivery = delivery) %>%
ggplot(aes(PC1, PC2, colour = proposed_grouping, shape = proposed_grouping)) +
geom_point(alpha = 0.8, size = 2) +
stat_ellipse(type = "norm") +
labs(x = "Principal Component 1 (44.6%)",
y = "Principal Component 2 (30.8%)") +
scale_colour_manual(values = c("#b6dfe2","#0A537D")) +
lims(x = c(-10,10),
y = c(-10,10)) +
coord_fixed() +
theme_minimal() +
theme(text = element_text(family = "Roboto", size = 10, colour = "grey20"),
plot.margin = margin(10, 10, 10, 10),
legend.position = "bottom",
legend.title = element_blank(),
legend.text  = element_text(size = 11),
axis.title.x = element_text(size = 11, margin = margin(10,0,0,0)),
axis.title.y = element_text(size = 11, margin = margin(0,10,0,0)),
panel.grid.major = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
axis.ticks = element_blank())
d <- data_recipe %>%
juice() %>%
dplyr::rename(Delivery = delivery) %>%
ggplot(aes(PC2, PC3, colour = proposed_grouping, shape = proposed_grouping)) +
geom_point(alpha = 0.8, size = 2) +
stat_ellipse(type = "norm") +
labs(x = "Principal Component 2 (30.8%)",
y = "Principal Component 3 (10.0%)") +
scale_colour_manual(values = c("#b6dfe2","#0A537D")) +
lims(x = c(-10,10),
y = c(-10,10)) +
coord_fixed() +
theme_minimal() +
theme(text = element_text(family = "Roboto", size = 10, colour = "grey20"),
plot.margin = margin(10, 10, 10, 10),
legend.position = "bottom",
legend.title = element_blank(),
legend.text  = element_text(size = 11),
axis.title.x = element_text(size = 11, margin = margin(10,0,0,0)),
axis.title.y = element_text(size = 11, margin = margin(0,10,0,0)),
panel.grid.major = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
axis.ticks = element_blank())
e <- data_recipe %>%
juice() %>%
dplyr::rename(Delivery = delivery) %>%
ggplot(aes(PC1, PC2, colour = proposed_grouping_2, shape = proposed_grouping_2)) +
geom_point(alpha = 0.8, size = 2) +
stat_ellipse(type = "norm") +
labs(x = "Principal Component 1 (44.6%)",
y = "Principal Component 2 (30.8%)") +
scale_colour_manual(values = c("#0A537D", "#7d340a", "#b6dfe2")) +
lims(x = c(-10,10),
y = c(-10,10)) +
coord_fixed() +
theme_minimal() +
theme(text = element_text(family = "Roboto", size = 10, colour = "grey20"),
plot.margin = margin(10, 10, 10, 10),
legend.position = "bottom",
legend.title = element_blank(),
legend.text  = element_text(size = 11),
axis.title.x = element_text(size = 11, margin = margin(10,0,0,0)),
axis.title.y = element_text(size = 11, margin = margin(0,10,0,0)),
panel.grid.major = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
axis.ticks = element_blank())
f <- data_recipe %>%
juice() %>%
dplyr::rename(Delivery = delivery) %>%
ggplot(aes(PC2, PC3, colour = proposed_grouping_2, shape = proposed_grouping_2)) +
geom_point(alpha = 0.8, size = 2) +
stat_ellipse(type = "norm") +
labs(x = "Principal Component 2 (30.8%)",
y = "Principal Component 3 (10.0%)") +
scale_colour_manual(values = c("#0A537D", "#7d340a", "#b6dfe2")) +
lims(x = c(-10,10),
y = c(-10,10)) +
coord_fixed() +
theme_minimal() +
theme(text = element_text(family = "Roboto", size = 10, colour = "grey20"),
plot.margin = margin(10, 10, 10, 10),
legend.position = "bottom",
legend.title = element_blank(),
legend.text  = element_text(size = 11),
axis.title.x = element_text(size = 11, margin = margin(10,0,0,0)),
axis.title.y = element_text(size = 11, margin = margin(0,10,0,0)),
panel.grid.major = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
axis.ticks = element_blank())
a + b
ggsave("figures/Figure_5.png", plot = last_plot())
c + d
ggsave("figures/Figure_6.png", plot = last_plot())
e + f
ggsave("figures/Figure_7.png", plot = last_plot())
my_skim <- skim_with(numeric = sfl("skewness" = skewness,
"kurtosis" = kurtosis,
"max" = max,
"min" = min,
"median" = median,
hist = NULL))
data_clean %>%
select(-delivery, -museum_id, -proposed_grouping, -proposed_grouping_2) %>%
pivot_longer(everything()) %>%
group_by(name) %>%
na.omit() %>%
my_skim() %>%
select(-skim_variable, -skim_type, -n_missing, -complete_rate, -numeric.p0, -numeric.p100) %>%
rename("variable" = "name",
"mean" = "numeric.mean",
"sd" = "numeric.sd",
"p25" = "numeric.p25",
"p50" = "numeric.p50",
"p75" = "numeric.p75",
"skewness" = "numeric.skewness",
"kurtosis" = "numeric.kurtosis",
"max" = "numeric.max",
"min" = "numeric.min",
"median" = "numeric.median") %>%
select(variable, min, max, median, mean, sd, p25, p75, kurtosis, skewness) %>%
mutate_at(2:10, round, 1) %>%
mutate(cv = (sd/mean) * 100)
# Optional GT view with %>%  gt()
data_clean %>%
select(-delivery, -museum_id, -proposed_grouping, -proposed_grouping_2) %>%
pivot_longer(everything()) %>%
group_by(name) %>%
na.omit() %>%
my_skim() %>%
select(-skim_variable, -skim_type, -n_missing, -complete_rate, -numeric.p0, -numeric.p100) %>%
rename("variable" = "name",
"mean" = "numeric.mean",
"sd" = "numeric.sd",
"p25" = "numeric.p25",
"p50" = "numeric.p50",
"p75" = "numeric.p75",
"skewness" = "numeric.skewness",
"kurtosis" = "numeric.kurtosis",
"max" = "numeric.max",
"min" = "numeric.min",
"median" = "numeric.median") %>%
select(variable, min, max, median, mean, sd, p25, p75, kurtosis, skewness) %>%
mutate_at(2:10, round, 1) %>%
mutate(cv = (sd/mean) * 100) %>%  gt()
data_clean %>%
select(-delivery, -museum_id, -proposed_grouping, -proposed_grouping_2) %>%
pivot_longer(everything()) %>%
group_by(name) %>%
na.omit() %>%
my_skim() %>%
select(-skim_variable, -skim_type, -n_missing, -complete_rate, -numeric.p0, -numeric.p100) %>%
rename("variable" = "name",
"mean" = "numeric.mean",
"sd" = "numeric.sd",
"p25" = "numeric.p25",
"p50" = "numeric.p50",
"p75" = "numeric.p75",
"skewness" = "numeric.skewness",
"kurtosis" = "numeric.kurtosis",
"max" = "numeric.max",
"min" = "numeric.min",
"median" = "numeric.median") %>%
select(variable, min, max, median, mean, sd, p25, p75, kurtosis, skewness) %>%
mutate_at(2:10, round, 1) %>%
mutate(cv = round((sd/mean) * 100), 1) %>%  gt()
data_clean %>%
select(-delivery, -museum_id, -proposed_grouping, -proposed_grouping_2) %>%
pivot_longer(everything()) %>%
group_by(name) %>%
na.omit() %>%
my_skim() %>%
select(-skim_variable, -skim_type, -n_missing, -complete_rate, -numeric.p0, -numeric.p100) %>%
rename("variable" = "name",
"mean" = "numeric.mean",
"sd" = "numeric.sd",
"p25" = "numeric.p25",
"p50" = "numeric.p50",
"p75" = "numeric.p75",
"skewness" = "numeric.skewness",
"kurtosis" = "numeric.kurtosis",
"max" = "numeric.max",
"min" = "numeric.min",
"median" = "numeric.median") %>%
select(variable, min, max, median, mean, sd, p25, p75, kurtosis, skewness) %>%
mutate_at(2:10, round, 1) %>%
mutate(cv = round((sd/mean) * 100), 2) %>%  gt()
mutate(cv = round((sd/mean) * 100, 2) %>%  gt()
data_clean %>%
select(-delivery, -museum_id, -proposed_grouping, -proposed_grouping_2) %>%
pivot_longer(everything()) %>%
group_by(name) %>%
na.omit() %>%
my_skim() %>%
select(-skim_variable, -skim_type, -n_missing, -complete_rate, -numeric.p0, -numeric.p100) %>%
rename("variable" = "name",
"mean" = "numeric.mean",
"sd" = "numeric.sd",
"p25" = "numeric.p25",
"p50" = "numeric.p50",
"p75" = "numeric.p75",
"skewness" = "numeric.skewness",
"kurtosis" = "numeric.kurtosis",
"max" = "numeric.max",
"min" = "numeric.min",
"median" = "numeric.median") %>%
select(variable, min, max, median, mean, sd, p25, p75, kurtosis, skewness) %>%
mutate_at(2:10, round, 1) %>%
mutate(cv = round((sd/mean) * 100, 2)) %>%  gt()
data_clean %>%
select(-delivery, -museum_id, -proposed_grouping, -proposed_grouping_2) %>%
pivot_longer(everything()) %>%
group_by(name) %>%
na.omit() %>%
my_skim() %>%
select(-skim_variable, -skim_type, -n_missing, -complete_rate, -numeric.p0, -numeric.p100) %>%
rename("variable" = "name",
"mean" = "numeric.mean",
"sd" = "numeric.sd",
"p25" = "numeric.p25",
"p50" = "numeric.p50",
"p75" = "numeric.p75",
"skewness" = "numeric.skewness",
"kurtosis" = "numeric.kurtosis",
"max" = "numeric.max",
"min" = "numeric.min",
"median" = "numeric.median") %>%
select(variable, min, max, median, mean, sd, p25, p75, kurtosis, skewness) %>%
mutate_at(2:10, round, 1) %>%
mutate(cv = round((sd/mean) * 100, 1)) %>%  gt()
ggsave("figures/Table_1.png", plot = last_plot())
data_clean %>%
select(-delivery, -museum_id, -proposed_grouping, -proposed_grouping_2) %>%
pivot_longer(everything()) %>%
group_by(name) %>%
na.omit() %>%
my_skim() %>%
select(-skim_variable, -skim_type, -n_missing, -complete_rate, -numeric.p0, -numeric.p100) %>%
rename("variable" = "name",
"mean" = "numeric.mean",
"sd" = "numeric.sd",
"p25" = "numeric.p25",
"p50" = "numeric.p50",
"p75" = "numeric.p75",
"skewness" = "numeric.skewness",
"kurtosis" = "numeric.kurtosis",
"max" = "numeric.max",
"min" = "numeric.min",
"median" = "numeric.median") %>%
select(variable, min, max, median, mean, sd, p25, p75, kurtosis, skewness) %>%
mutate_at(2:10, round, 1) %>%
mutate(cv = round((sd/mean) * 100, 1)) %>%  gt() %>% gtsave(filename = "figures/Table_1.html")
data_clean %>%
select(-delivery, -museum_id, -proposed_grouping, -proposed_grouping_2) %>%
pivot_longer(everything()) %>%
group_by(name) %>%
na.omit() %>%
my_skim() %>%
select(-skim_variable, -skim_type, -n_missing, -complete_rate, -numeric.p0, -numeric.p100) %>%
rename("variable" = "name",
"mean" = "numeric.mean",
"sd" = "numeric.sd",
"p25" = "numeric.p25",
"p50" = "numeric.p50",
"p75" = "numeric.p75",
"skewness" = "numeric.skewness",
"kurtosis" = "numeric.kurtosis",
"max" = "numeric.max",
"min" = "numeric.min",
"median" = "numeric.median") %>%
select(variable, min, max, median, mean, sd, p25, p75, kurtosis, skewness) %>%
mutate_at(2:10, round, 1) %>%
mutate(cv = round((sd/mean) * 100, 1)) %>%  gt() %>% gtsave(filename = "figures/Table_1.png")
data_clean %>%
select(-delivery, -museum_id, -proposed_grouping, -proposed_grouping_2) %>%
pivot_longer(everything()) %>%
group_by(name) %>%
na.omit() %>%
my_skim() %>%
select(-skim_variable, -skim_type, -n_missing, -complete_rate, -numeric.p0, -numeric.p100) %>%
rename("variable" = "name",
"mean" = "numeric.mean",
"sd" = "numeric.sd",
"p25" = "numeric.p25",
"p50" = "numeric.p50",
"p75" = "numeric.p75",
"skewness" = "numeric.skewness",
"kurtosis" = "numeric.kurtosis",
"max" = "numeric.max",
"min" = "numeric.min",
"median" = "numeric.median") %>%
select(variable, min, max, median, mean, sd, p25, p75, kurtosis, skewness) %>%
mutate_at(2:10, round, 1) %>%
mutate(cv = round((sd/mean) * 100, 1)) %>%  gt() %>% gtsave(filename = "figures/Table_1.html")
